<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="js/jquery-2.1.3.min.js"></script>
    <link rel="stylesheet" href="css/main.css">

    <title>vokete</title>
</head>
<body>
    <header class="header">
        <div class="logoWrapper">
            <img src="img/logo.png" alt="logo" class="logo">
        </div>
    </header>
    <main>
        <a href="#" id="odai" class="btn">お題を選ぶ</a>
        <div id="img" class="mainimage"><img src="img/15.jpg" alt="画像" id="gazou"></div>
        <textarea id="hitokoto"></textarea>
        <p id="save">投稿する</p>
        <p class="past-title">過去の投稿</p>
        <p id="clear">Allはずい！</p>
        <div id="result">
            <!-- ここに投稿内容が入る -->
        </div>
    </main>
<script>
//画像のランダム表示 
$("#odai").on("click",function(){
    //乱数1〜10
    const r = Math.ceil(Math.random()*15);
    if(r==1){
        $("#img").html('<img src="img/1.jpg" alt="画像" id="gazou">');
    }
    if(r==2){
        $("#img").html('<img src="img/2.jpg" alt="画像" id="gazou">');
    }
    if(r==3){
        $("#img").html('<img src="img/3.jpg" alt="画像" id="gazou">');
    }
    if(r==4){
        $("#img").html('<img src="img/4.jpg" alt="画像" id="gazou">');
    }
    if(r==5){
        $("#img").html('<img src="img/5.jpg" alt="画像" id="gazou">');
    }
    if(r==6){
        $("#img").html('<img src="img/6.jpg" alt="画像" id="gazou">');
    }
    if(r==7){
        $("#img").html('<img src="img/7.jpg" alt="画像" id="gazou">');
    }
    if(r==8){
        $("#img").html('<img src="img/8.jpg" alt="画像" id="gazou">');
    }
    if(r==9){
        $("#img").html('<img src="img/9.jpg" alt="画像" id="gazou">');
    }
    if(r==10){
        $("#img").html('<img src="img/10.jpg" alt="画像" id="gazou">');
    }
    if(r==11){
        $("#img").html('<img src="img/11.jpg" alt="画像" id="gazou">');
    }
    if(r==12){
        $("#img").html('<img src="img/12.jpg" alt="画像" id="gazou">');
    }
    if(r==13){
        $("#img").html('<img src="img/13.jpg" alt="画像" id="gazou">');
    }
    if(r==14){
        $("#img").html('<img src="img/14.jpg" alt="画像" id="gazou">');
    }
    if(r==15){
        $("#img").html('<img src="img/15.jpg" alt="画像" id="gazou">');
    }

});

// 1.投稿
$("#save").on("click", function(){
const key   = $("#hitokoto").val();
const image = document.getElementById("gazou");
const value = image.getAttribute("src");
localStorage.setItem(key, value); //データ保存
//一覧表示に追加
const g = '<div class="bokeimage"><img src="'+value+'" alt="画像" class="bokegazou"><p class="bokeru">'+key+'</p><button class="delete">はずい</button></div>'
$("#result").append(g);
//id+連番をつける
$(function(){
    $(".bokeimage").each(function(i){
    $(this).attr('id','bokeimage' + (i+1));
    });
});
$(function(){
    $(".bokeru").each(function(i){
    $(this).attr('id','bokeru' + (i+1));
    });
});
const textClear = document.getElementById("hitokoto");
textClear.value = "";
});

//2.ALLclear クリックイベント
$("#clear").on("click",function(){
    localStorage.clear();
    $("#result").empty();
});

//3.ページ読み込み：保存データ取得表示
for(let i=0; i<localStorage.length; i++){
    const key   = localStorage.key(i);
    const value = localStorage.getItem(key);
    const image = '<div class="tokoimage"><img src="'+value+'" alt="画像" class="bokegazou"><p class="boke">'+key+'</p><button class="delete">はずい</button></div>'
    $("#result").append(image);
    //id+連番をつける
    $(function(){
        $(".tokoimage").each(function(i){
        $(this).attr('id','tokoimage' + (i+1));
        });
    });
    $(function(){
        $(".boke").each(function(i){
        $(this).attr('id','boke' + (i+1));
        });
    });
}

//4.1レコードのみ削除
$("body").on("click",".delete",function() {
    const getId  = $(this).prev().attr('id'); //キーになっているテキストのIDを取得
    const getId2 = $(this).parent().attr('id'); //消す場所の要素全体のID名を取得
    console.log(getId)
    console.log(getId2)
    const key    = document.getElementById(getId).textContent; //キーになっているテキストを取得
    const name   = document.getElementById(getId2); //ID要素を取得
    localStorage.removeItem(key) //localstorageの1レコードを削除
    $(name).remove(); //要素の削除
});

</script>
<footer>created by Takuchan of G'sACADEMIY UNIT_SAPPORO_DEV1</footer>
</body>
</html>